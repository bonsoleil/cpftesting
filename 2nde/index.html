<!DOCTYPE html>
<head>
	
	<title> CPF Bon Soleil </title>
	
</head>
<body>
<center>
	<h1> Test 10</h1>
	<br>
	<h1>Temperature</h1>
	<span id=temperature> none </span>
	
	<h1> Flame </h1>
	<span id=flame> none </span>
	
	<h1> Button </h1>
	<span id=button> none </span>
</center>
<script>
	
	var temp;
	var tempConverted;
	var button;
	var flame;
	
	setup();
	
	function toCelsius(value) {
		var resistance = parseFloat((1023-value) * 10000 / value);
		var temperature = 1 / (Math.log(resistance / 10000) / 3975+1 / 298.15) - 273.15;
		
		return temperature.toFixed(2);
	}
	
	function main() {
		if(cpf){
			temp = cpf.get("temperature sensor");
			tempConverted = toCelsius(temp);
			button = cpf.get("d2");
			flame = cpf.get("d6");
			document.getElementById("button").innerHTML = button;
			document.getElementById("temperature").innerHTML = tempConverted;
			document.getElementById("flame").innerHTML = flame;
			cpf.request('["tone_play", 8, 261, 100]');
		}
		setTimeout(main, 1000);
	}
	
	main();
	
	
	
	function setup(){
		if(cpf){
			cpf.setPinMode('["resetPin"], ["setPinMode", "analog", 1, "INPUT"], ["setPinMode", "digital", 2, "INPUT"], ["setPinMode", "digital", 6, "INPUT"], ["setPinMode", "digital", 5, "TONE"]');
		}
	}
</script>
</body>
</html>
