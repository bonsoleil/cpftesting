</head>

<body>
	<title> Cloud Profesor </title>
<center>
	<h1>Ama 1</h1>
	<h1>Flame Sensor:</h1>
	<span id="flamevalue">none</span>
	<br>
	<h1>Temperature Sensor</h1>
	<span id="tempvalue">none</span>
	<br>
	<h1>Button</h1>
	<span id="buttonValue">none</span>
	
</center>

<script>
	
	var flamedata;
	var button; 
	var tempdata;
	var tempConverted;
	var newTemp;
	
	function loop() {
		if(cpf){
			flamedata = cpf.get("d5");
			tempdata = cpf.get("temperature sensor");
			newTemp = cpf.get("a1");
			button = cpf.get("d4");
			tempConverted = toCelsius(tempdata);
			document.getElementById("tempvalue").innerHTML = tempConverted;
			document.getElementById("flamevalue").innerHTML = flamedata;
			
			
		}
		setTimeout(loop, 1000);
	}
	
	function alarm(){
		if(cpf){
			if(flamedata == 0 || button == 1){
				cpf.request(["tone_play", 3, 329, 1000], ["tone_play", 3, 293, 500], ["tone_play", 3, 261, 500]);
		}
	}
	
	// Temperature
	function toCelsius(value) {
		var resistance = parseFloat((1023-value) * 10000 / value);
		var temperature = 1 / (Math.log(resistance / 10000) / 3975+1 / 298.15) - 273.15;
		
		return temperature.toFixed(2);
	}
	
	setup();
	loop();
	
	// cpf setup
	function setup(){
		if(cpf)
		cpf.setPinMode('["resetPin"], ["setPinMode", "analog", 1, "INPUT"], ["setPinMode", "digital", 3, "TONE"], ["setPinMode", "digital", 4, "INPUT"], ["setPinMode", "digital", 5, "INPUT"]'); 
	}
	
	</script>
</body>
</html>
