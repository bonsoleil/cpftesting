</head>
<body>
	<title> CPF </title>
<center>
	<h1>6Ã¨me CPF v2</h1>
	<br>
	<h1>Temperature Sensor</h1>
	<span id="tempvalue">none</span>
</center>

<script>

var temp;
var tempconverted;

	function toCelsius(value) {
		var resistance = parseFloat((1023-value) * 10000 / value);
		var temperature = 1 / (Math.log(resistance / 10000) / 3975+1 / 298.15) - 273.15;

		return temperature.toFixed(2);
	}

	function main(){
		if (cpf){
			temp = cpf.get("temperature sensor");
			tempconverted = toCelsius(temp);

			if (tempConverted < 15) {
				cpf.request('["analogWrite", 5, 0]');
			}

			if (tempConverted > 15 && tempConverted < 20) {
				cpf.request('["analogWrite", 5, 100]');
			}

			if (tempConverted > 20 && tempConverted < 25) {
				cpf.request('["analogWrite", 5, 200]');
			}

			if (tempConverted > 25) {
				cpf.request('["analogWrite", 5, 255]');
			}

			document.getElementById("tempvalue").innerHTML = tempconverted;
		}
		setTimeout(main, 1000);
	}

	function setup(){
		if (cpf) {
			cpf.setPinMode('["resetPin"],["setPinMode", "analog", 0, "INPUT"],["setPinMode", "analog", 1, "INPUT"], ["setPinMode", "digital", 5,"PWM"], ["grove_newChainableLED", 7, 8, 1]');
		}
	}

		setup();
		main();
	</script>
</body>
</html>
